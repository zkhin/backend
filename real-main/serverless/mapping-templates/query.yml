- type: Query
  field: usernameStatus
  dataSource: DynamodbDataSource
  caching:
    keys:
      - $context.args.username

- type: Query
  field: self
  request: Query.self/before.request.vtl
  response: Query.self/after.response.vtl
  kind: PIPELINE
  functions:
    - Users.batchGet
  caching:
    keys:
      - $context.identity.cognitoIdentityId

- type: Query
  field: user
  request: Query.user/before.request.vtl
  response: Query.user/after.response.vtl
  kind: PIPELINE
  functions:
    - Users.batchGet
    - Users.batchGet.blockerStatus
    - Users.batchGet.followedStatus
  caching:
    keys:
      - $context.args.userId
      - $context.identity.cognitoIdentityId

- type: Query
  field: searchUsers
  dataSource: ElasticSearchDataSource
  caching:
    keys:
      - $context.args.searchToken
      - $context.args.limit
      - $context.args.nextToken

- type: Query
  field: trendingUsers
  dataSource: DynamodbDataSource
  caching:
    keys:
      - $context.args.limit
      - $context.args.nextToken

- type: Query
  field: findContacts
  dataSource: LambdaDataSource
  request: false
  response: Lambda.response.vtl

- type: Query
  field: post
  request: Query.post/before.request.vtl
  response: Query.post/after.response.vtl
  kind: PIPELINE
  functions:
    - Posts.batchGet
    - Posts.filterBy.postStatus
    - Users.beginPipeline
    - Users.batchGet
    - Users.batchGet.blockerStatus
    - Users.filterBy.blockerStatus
    - Users.batchGet.followedStatus
    - Users.filterBy.followedStatus
    - Users.endPipeline
  caching:
    keys:
      - $context.args.postId
      - $context.identity.cognitoIdentityId

- type: Query
  field: trendingPosts
  dataSource: DynamodbDataSource
  caching:
    keys:
      - $context.args.limit
      - $context.args.nextToken

- type: Query
  field: album
  request: Query.album/before.request.vtl
  response: Query.album/after.response.vtl
  kind: PIPELINE
  functions:
    - Albums.batchGet
    - Users.beginPipeline
    - Users.batchGet
    - Users.batchGet.blockerStatus
    - Users.filterBy.blockerStatus
    - Users.batchGet.followedStatus
    - Users.filterBy.followedStatus
    - Users.endPipeline
  caching:
    keys:
      - $context.args.albumId
      - $context.identity.cognitoIdentityId

- type: Query
  field: chat
  request: Query.chat/before.request.vtl
  response: Query.chat/after.response.vtl
  kind: PIPELINE
  functions:
    - ChatMemberships.batchGet
    - Query.chat.transform
    - Chats.batchGet
  caching:
    keys:
      - $context.args.chatId
      - $context.identity.cognitoIdentityId

- type: Query
  field: findPosts
  dataSource: LambdaDataSource
  request: false
  response: Lambda.response.vtl

- type: Query
  field: similarPosts
  dataSource: LambdaDataSource
  request: false
  response: Lambda.response.vtl

- type: Query
  field: searchKeywords
  dataSource: LambdaDataSource
  request: false
  response: Lambda.response.vtl

- type: Query
  field: swipedRightUsers
  dataSource: LambdaDataSource
  request: false
  response: Lambda.response.vtl
